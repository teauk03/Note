# 1. IP 주소
* 네트워크 상에서 호스트를 식별하기 위해 사용되는 주소
* 물리적인 위치에 구애 받지 않고 할당, 변경되어 유동적임
* `네트워크 주소` + `호스트 주소` 이러한 구조를 가짐

<br></br>

## 1.1. 네트워크 주소, 호스트 주소
* 네트워크 상에서 호스트 비트가 많을 수록 더 많은 기기에 IP를 할당해 줄 수 있음
* 옥텟은 서브넷 마스크와 밀접하게 연결되어 있어, 어디까지를 네트워크/호스트로 구분할지 결정하는 기준이 됨
```
IP: 192.168.0.1
``` 
* **네트워크 주소:** 16bit
    * 11000000.10101000
* **호스트 주소:** 16bit
    * 00000000.00000001

<br></br>

## 1.2. 클래스풀 주소 체계
* **클래스 (Class)**
    * 네트워크의 크기에 따라 IP 주소를 분리하는 기준
    * 필요한 `IP의 갯수에 따라` <U>네트워크 크기를 가변적으로 조절</U>해서 네트워크 구조, 호스트 주소를 기획하고 구축할 수 있음 
* 이 클래스로 IP 주소를 관리하는 체계를 클래스풀 주소 체계(Classful Addressing) 이라고 함
* 각 클래스에서 할당 가능한 호스트 수는 `네트워크 주소`와 `브로드캐스트 주소`로 예약된 **2개의 주소**를 제외하기 때문에 `계산식에서 -2`를 해줌

![alt text](<../설명사진/클래스 풀 주소 체게.png>)

| 구분   | IP 범위                     | 네트워크/호스트 비트       | 최대 호스트 수         | 용도           | 식별 비트     |
|--------|----------------------------|---------------------------|----------------------|---------------|-------------|
| **A**  | 0.0.0.0 ~ 127.255.255.255  | 네트워크 8bit / 호스트 24bit | 약 16,777,214 (2²⁴-2) | 대규모 네트워크 | 첫 비트: 0   |
| **B**  | 128.0.0.0 ~ 191.255.255.255 | 네트워크 16bit / 호스트 16bit | 약 65,534 (2¹⁶-2)     | 중규모 네트워크 | 첫 두 비트: 10 |
| **C**  | 192.0.0.0 ~ 223.255.255.255 | 네트워크 24bit / 호스트 8bit  | 254 (2⁸-2)           | 소규모 네트워크 | 첫 세 비트: 110 |



<br></br>

## 1.3. 클래스리스 주소 체계 (Classless Addressing, CIDR)
* 클래스풀 주소 체계의 한계를 고안해 발전 시킨 체계
    * **그 한계가 무엇인가?**
        * 네트워크 크기를 A/B/C로 딱 세 가지로만 나눠야 해서, 네트워크 규모와 필요한 호스트 수가 맞지 않으면 IP 자원이 낭비됨
* 클래스에 구애 받지 않고 네트워크 영역을 나누어서 호스트에게 IP 주소 공간을 할당하는 방식
* 현대에 가장 많이 활용되고 있음


### 1.3.1. 서브넷 마스크 
* IP주소의 네트워크, 호스트를 구분하는 역할을 수행하는 **32bit**의 숫자
* IP주소와 같이 **4옵텟**으로 표현됨
* 각 비트가 `1 -> 네트워크`, `0 -> 호스트` 
* 라우터나 스위치 같은 네트워크 장비가 이 서브넷 마스크를 활용해 IP가 같은 네트워크에 있는지를 판단함 


| 클래스 | 기본 서브넷 마스크  | 이진수 표현                         | CIDR 표기 | 네트워크/호스트 비트         |
|--------|-------------------|-------------------------------------|-----------|----------------------------|
| **A**  | 255.0.0.0         | 11111111.00000000.00000000.00000000 | /8        | 네트워크 8bit / 호스트 24bit |
| **B**  | 255.255.0.0       | 11111111.11111111.00000000.00000000 | /16       | 네트워크 16bit / 호스트 16bit |
| **C**  | 255.255.255.0     | 11111111.11111111.11111111.00000000 | /24       | 네트워크 24bit / 호스트 8bit  |

### 1.3.2. 서브넷팅
* 기존의 네트워크를 더 작은 네트워크로 나누는 작업
* 하나의 IP 대역을 여러개의 네트워크로 나누어 효율적으로 IP를 사용하기 위해 만들어짐
* **서브넷팅 계산 방법**
    1. **네트워크 갯수 기준으로 계산하는 방법**
        * 공식: `2^n ≥ 필요한 네트워크 수`
        * 여기서 `n`은 **호스트 비트 중 몇 개를 네트워크 비트로 가져올지** 결정 
    2. **호스트 수 기준으로 계산**
        * 공식: `2^h - 2 ≥ 필요한 호스트 수`  

<br></br>

# 2. 공인/사설 IP 주소

## 2.1. 공인 IP 주소
* **인터넷에 직접 연결이 가능한 주소**
* 전세계에서 고유한 IP 주소 
* ISP, 공익 IP 주소 할당 기관을 통해 할당 받을 수 있음 

## 2.2. 사설 IP 주소
* 사설 네트워크에서 사용하기 위한 IP 주소
* 내부 네트워크에서만 IP를 사용할 수 있음
* 라우터나 NAT이라는 기술을 통해 외부와 통신함

**지정된 사설 IP 대역**

| 클래스 | IP 범위 |
|--------|----------|
| A | 10.0.0.0 ~ 10.255.255.255 |
| B | 172.16.0.0 ~ 172.31.255.255 |
| C | 192.168.0.0 ~ 192.168.255.255 |

- **EX**
    * 10.0.1.100 - 사내 서버 IP
    * 192.168.0.1 - 가정 공유기

<br></br>

# 3. 정적/동적 IP 즈소

## 3.1. 정적 IP 주소
![alt text](<../설명사진/정적할당 mac.png>)
* 호스트에 직접 IP 주소를 직접 부여하여 할당된 IP주소
* 한번 이렇게 부여된 IP주소는 해당 기기를 재부팅하여도 변하지 않음 **(불변)**

## 3.2. 동적 IP 주소 
![alt text](<../설명사진/동적할당 mac.png>)
* 호스트가 직접 IP주소를 입력하지 않아도 <U>IP가 동적으로 할당</U>됨
    * 이렇게 동적으로 할당된 IP를 동적 IP 주소라고 부름
* 동적할당에서 가장 많이 사용되는 프로토콜은 `DHCP`가 있음

### 3.2.1. DHCP (Dynamic Host Configuration Protocol)
* 네트워크에 연결된 기기가 자동으로 IP 주소, 서브넷 마스크, 게이트웨이, DNS 등 네트워크 설정 정보를 받을 수 있도록 서버가 할당해주는 프로토콜
* 장비마다 수동으로 IP를 설정할 필요 없이, 연결만 하면 자동으로 IP가 할당되니 관리가 훨씬 간편하며, IP 충돌을 방지할 수 있음

* **DHCP 동작과정**
![alt text](<../설명사진/DHCP 시퀀스.png>)

1. **Discover** (Host -> DHCP Server)
    * 호스트가 DHCP 서버를 찾는 `Discover 메세지를 전송` (브로드 캐스트로 전송)
    * 전송 하는 시점에선 IP를 할당 받지 못함 (IP주소: 0.0.0.0)
2. **Offer** (DHCP Server -> Host)
    * DHCP 서버가 `Discover 메세지`를 받음
    * 호스트에게 임시 IP주소 + 네트워크 정보(서브넷 마스크, 게이트 웨이, DNS ..)를 `제안하는 Offer 메세지`를 보냄
    * DHCP 서버가 여러개 있다면 이 Offer 메세지가 여러개 일 수 있음
3. **Request** (Host -> DHCP Server)
    * DHCP Server가 보낸 Offer 메세지에 대한 Host의 요청
    * Offer 메세지 중에 이 IP를 사용하겠다고 DHCP 서버에 Request 메세지를 보냄 (브로드 캐스트로 전송됨)
4. **ACK**  (DHCP Server -> Host)
    * Host가 보낸 Request 메세지를 DHCP 서버에서 승인함
    * 최정적으로 IP 주소를 확정하여 Acknowledge(ACK) 메시지를 전송.
        * 이떄 `IP 임대 기간(Lease Time)과 갱신 시점`이 함께 설정되어 호스트는 정해진 기간 동안 IP를 사용할 수 있음